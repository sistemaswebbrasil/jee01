package ${bean.package};

import java.io.Serializable;
import javax.enterprise.context.RequestScoped;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.inject.Named;
import lombok.Getter;
import lombok.Setter;

import ${entity.package}.${entity.class};
import ${service.package}.${service.class};


@Getter
@Setter
@Named
@RequestScoped
public class ${bean.class} implements Serializable {

	private static final long serialVersionUID = 1L;
	
	@Inject
	private ${service.class} service;
	
    @Inject
    private FacesContext facesContext;
    	
	private ${entity.id.type} ${entity.id.var};
	private ${entity.class} ${entity.var};
    
    public void init() {    
        if (${entity.id.var} == null) {
            ${entity.var} = new ${entity.class}();
        } else {
			${entity.var} = service.findById(${entity.id.var});
        }
    }
    
    public String save() throws Throwable {
    	if (${entity.var}.getId() == null) {
            service.create(${entity.var});
        } else {
            service.update(${entity.var});
        }
        FacesMessage info = new FacesMessage( "Registro salvo com sucesso!!");
        facesContext.addMessage(null, info);
        return "/index.xhtml?faces-redirect=true";
    }
    
	public void delete(${entity.id.type} ${entity.id.var}) {
		try {
			service.deleteById(${entity.id.var});
			MessageUtil.addSuccessMessage("Excluído com sucesso");
			
	        FacesMessage info = new FacesMessage( "Excluído com sucesso!!");
	        facesContext.addMessage(null, info);			

		} catch (Exception e) {
			FacesMessage info = new FacesMessage(FacesMessage.SEVERITY_ERROR, "Erro", "Não foi possível excluir o registro");
			facesContext.addMessage(null, info);			
			LOG.log(Level.SEVERE,"Erro", "Não foi possível excluir o registro",e);			
		}
	}

}
